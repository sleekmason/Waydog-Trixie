#!/bin/bash

read -p "   [0;32mNano Installer[0m

   Nano comes pre-installed, but the configuration file is not located
   where it can be easily adjusted, and there is no right-click action
   added to the file manager for editing files. 
   
   This script adds a right-click action to your file manager to allow
   choosing nano when editing files, and also copies the configuration
   file to ~/.config/nano/nanorc for easy user adjustment.
   
   Note * Maybe try out Nano if you haven't before making this change.

   [0;32m-------------------------------------------------------------------

   Press enter to install Nano editor with customizations in place.

   -------------------------------------------------------------------[0m

   Or, close this terminal window to quit the install." ;
## Make sure of internet connection
if : >/dev/tcp/8.8.8.8/53; then
echo ""
## Remove old .desktop file
sudo rm -f /usr/share/applications/nano.desktop

## Install nano if not existing
if ! [[ $(command -v nano) ]]; then
sudo apt update && sudo apt install -y nano
fi

## Make nano.desktop file
sudo touch /usr/share/applications/nano.desktop

## Copy lines for nano.desktop file
{
echo "[Desktop Entry]"
echo "Encoding=UTF-8"
echo "Version=1.0"
echo "Type=Application"
echo "NoDisplay=false"
echo "Exec=x-terminal-emulator -T 'Nano' -e nano %f"
echo "Name=Nano"
echo "Comment=Nano terminal text editor"
echo "Icon=utilities-terminal"
echo "Categories=Utility;TextEditor;Development;"
echo "Keywords=editor;texteditor;text;terminal;"
echo "MimeType=text/plain;";} | sudo tee -a "/usr/share/applications/nano.desktop" > /dev/null

## update desktop database
sudo update-desktop-database

## Make ~/.config/nano/nanorc if doesn't exist
if [ ! -e "$HOME/.config/nano" ]; then
   mkdir "$HOME/.config/nano"
fi

if [ -e "$HOME/.config/nano/nanorc" ]; then
     cp "$HOME/.config/nano/nanorc" "$HOME/.config/nano/nanorc.bak"
fi

## Copy sample.nanorc to ~/.config/nano/nanorc
cp "/usr/share/doc/nano/examples/sample.nanorc" "$HOME/.config/nano/nanorc"

## Copy code for color lines user
{
echo ""
echo '## See above for full options plus description of options and colors.'
echo '## Options'
echo 'set emptyline'
echo 'set indicator'
echo 'set linenumbers'
echo 'set mouse'
echo ""
echo '## Set user colors'
echo 'set titlecolor bold,lightgreen,black'
echo 'set promptcolor bold,green,black'
echo 'set statuscolor bold,green,black'
echo 'set selectedcolor lightyellow,magenta'
echo 'set stripecolor yellow'
echo 'set scrollercolor cyan'
echo 'set numbercolor bold,green'
echo 'set keycolor lightgreen'
echo 'set functioncolor lightcyan'
echo ""
echo '## Syntax highlighting for different color schemes can be found in'
echo '## /usr/share/nano Adjust this line. Currently selects most. l.242'
echo ""
echo 'include "/usr/share/nano/*.nanorc"';} | tee -a "$HOME/.config/nano/nanorc" > /dev/null

echo "   [0;32m-----------------------------------------------------------[0m"
echo ""
echo "   [0;33mAll Finished![0m"
echo ""
echo "   [0;32mYou should find a new menu entry in the file manager.[0m"
echo ""
echo "   [0;31mUse 'Ctrl + x' or 'F2' to exit nano.[0m"
echo ""
echo "   [0;33mSee the configuration file: ~/.config/nano/nanorc for other"
echo "   possible customization options.[0m"
echo ""
echo "   [0;32m-----------------------------------------------------------[0m"
echo ""
else
echo ""
 echo "   [0;31m-----------------------------------------------------[0m"
 echo ""
 echo "   [0;33mNo Internet connection. Please connect and try again.[0m"
 echo ""
 echo "   [0;31m-----------------------------------------------------[0m"
echo ""
fi
read -n1 -p " Press any key to quit this dialog ... "
