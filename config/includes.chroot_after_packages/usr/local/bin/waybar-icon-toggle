#!/bin/bash
# 4-step toggle for Waybar icons
# Made by sleekmason for Waydog 21 Feb 2026

CONFIG="$HOME/.config/waybar/config.jsonc"

LONG=21
SHORT=12

current=$(awk '/"wlr\/taskbar": {/,/}/ { if($0 ~ /"format":/) print }' "$CONFIG" \
          | grep -Po '"format":\s*"\K[^"]+')

case "$current" in
    "{title:"*)
        new="{icon}"
        ;;
    "{icon}")
        new="{icon} {title:.$LONG}"
        ;;
    "{icon} {title:.$LONG}")
        new="{icon} {title:.$SHORT}"
        ;;
    "{icon} {title:.$SHORT}")
        new="{title:.$LONG}"
        ;;
    *)
        new="{title:.$LONG}"
        ;;
esac

sed -i '/"wlr\/taskbar": {/,/}/ s/^\(\s*"format":\s*\)".*"/\1"'"$new"'"/' "$CONFIG"

pkill -x waybar
waybar &
